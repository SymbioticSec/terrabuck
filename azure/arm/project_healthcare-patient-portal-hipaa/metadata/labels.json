{
  "project_labels": {
    "project_id": "healthcare-patient-portal-hipaa",
    "overall_security_posture": "critical",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 0,
        "high": 3,
        "medium": 4
      },
      "by_type": {
        "access_control": 3,
        "encryption": 2,
        "network": 2,
        "audit": 1,
        "identity": 1
      },
      "by_trivy_service": {
        "database": 2,
        "storage": 1,
        "appservice": 3,
        "keyvault": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 10,
    "trivy_coverage": {
      "rules_represented": [
        "AZURE-DATABASE-NO_PUBLIC_ACCESS",
        "AZURE-STORAGE-DEFAULT_ACTION_DENY",
        "AZURE-APPSERVICE-ENFORCE_HTTPS",
        "AZURE-KEYVAULT-ENSURE_KEY_EXPIRY",
        "AZURE-DATABASE-ENABLE_AUDIT",
        "AZURE-APPSERVICE-USE_SECURE_TLS_POLICY",
        "AZURE-APPSERVICE-ACCOUNT_IDENTITY_REGISTERED"
      ],
      "services_covered": [
        "database",
        "storage",
        "appservice",
        "keyvault"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AZURE-DATABASE-NO_PUBLIC_ACCESS",
      "trivy_rule_info": {
        "original_file": "no_public_access.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/database"
      },
      "vulnerability_class": "network_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "database_credentials"
      ],
      "mitigation_strategies": [
        "disable_public_network_access",
        "implement_private_endpoints",
        "configure_firewall_rules",
        "use_vnet_service_endpoints"
      ],
      "code_patterns": {
        "vulnerable_pattern": "public_network_access_enabled = true",
        "secure_pattern": "public_network_access_enabled = false"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_exposure",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-STORAGE-DEFAULT_ACTION_DENY",
      "trivy_rule_info": {
        "original_file": "default_action_deny.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/storage"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 8,
      "compliance_relevance": [
        "HIPAA",
        "GDPR",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "storage_account_knowledge"
      ],
      "mitigation_strategies": [
        "set_default_action_deny",
        "configure_allowed_ip_ranges",
        "implement_private_endpoints",
        "use_managed_identities"
      ],
      "code_patterns": {
        "vulnerable_pattern": "default_action = \"Allow\"",
        "secure_pattern": "default_action = \"Deny\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-ENFORCE_HTTPS",
      "trivy_rule_info": {
        "original_file": "enforce_https.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/appservice"
      },
      "vulnerability_class": "encryption_in_transit",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "HIPAA",
        "PCI-DSS",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_interception_capability",
        "man_in_middle_position"
      ],
      "mitigation_strategies": [
        "enable_https_only",
        "configure_ssl_certificates",
        "implement_hsts_headers",
        "redirect_http_to_https"
      ],
      "code_patterns": {
        "vulnerable_pattern": "https_only = false or missing https_only",
        "secure_pattern": "https_only = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption_in_transit",
        "severity_numeric": 7.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-KEYVAULT-ENSURE_KEY_EXPIRY",
      "trivy_rule_info": {
        "original_file": "ensure_key_expiry.yaml",
        "service_category": "keyvault",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/keyvault"
      },
      "vulnerability_class": "key_management",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 6,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "key_compromise",
        "long_term_access"
      ],
      "mitigation_strategies": [
        "set_key_expiration_dates",
        "implement_key_rotation_policies",
        "automate_key_lifecycle_management",
        "monitor_key_usage"
      ],
      "code_patterns": {
        "vulnerable_pattern": "missing expiration_date property",
        "secure_pattern": "expiration_date = \"2024-12-31T00:00:00Z\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "key_management",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-DATABASE-ENABLE_AUDIT",
      "trivy_rule_info": {
        "original_file": "enable_audit.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/database"
      },
      "vulnerability_class": "audit_logging",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS",
        "GDPR"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "database_access",
        "malicious_intent"
      ],
      "mitigation_strategies": [
        "enable_extended_auditing_policy",
        "configure_audit_log_retention",
        "set_up_log_monitoring",
        "implement_alerting_rules"
      ],
      "code_patterns": {
        "vulnerable_pattern": "missing azurerm_mssql_server_extended_auditing_policy resource",
        "secure_pattern": "azurerm_mssql_server_extended_auditing_policy configured"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "audit_logging",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-USE_SECURE_TLS_POLICY",
      "trivy_rule_info": {
        "original_file": "use_secure_tls_policy.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/appservice"
      },
      "vulnerability_class": "weak_cryptography",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "HIPAA",
        "PCI-DSS",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "tls_downgrade_capability",
        "network_interception"
      ],
      "mitigation_strategies": [
        "set_min_tls_version_1_2",
        "disable_weak_cipher_suites",
        "implement_perfect_forward_secrecy",
        "regular_ssl_certificate_updates"
      ],
      "code_patterns": {
        "vulnerable_pattern": "min_tls_version = \"1.0\"",
        "secure_pattern": "min_tls_version = \"1.2\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "weak_cryptography",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-ACCOUNT_IDENTITY_REGISTERED",
      "trivy_rule_info": {
        "original_file": "account_identity_registered.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/azure/appservice"
      },
      "vulnerability_class": "identity_management",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "HIPAA"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "credential_access",
        "application_compromise"
      ],
      "mitigation_strategies": [
        "enable_managed_identity",
        "remove_hardcoded_credentials",
        "implement_rbac_policies",
        "use_key_vault_references"
      ],
      "code_patterns": {
        "vulnerable_pattern": "missing identity block in app service",
        "secure_pattern": "identity { type = \"SystemAssigned\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "identity_management",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "compliance_mapping",
      "trivy_rule_matching",
      "remediation_recommendation",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,MEDIUM .",
      "expected_trivy_output": "7 vulnerabilities across database, storage, appservice, and keyvault services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_hipaa_compliance_requirements_in_cloud_infrastructure",
      "learn_trivy_security_scanning_for_azure_resources",
      "identify_common_azure_security_misconfigurations",
      "apply_defense_in_depth_principles_to_healthcare_applications",
      "master_secure_azure_service_configuration_patterns"
    ],
    "prerequisite_knowledge": [
      "basic_azure_services_knowledge",
      "infrastructure_as_code_concepts",
      "hipaa_compliance_fundamentals",
      "network_security_principles",
      "encryption_and_key_management_basics"
    ],
    "difficulty_level": "advanced",
    "estimated_review_time": 45,
    "key_takeaways": [
      "healthcare_applications_require_multiple_layers_of_security_controls",
      "trivy_can_detect_most_common_azure_security_misconfigurations",
      "network_isolation_is_critical_for_protecting_patient_data",
      "proper_audit_logging_is_essential_for_hipaa_compliance",
      "managed_identities_reduce_credential_exposure_risks"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "azure",
    "language": "arm_template",
    "component_count": 6,
    "file_count": 3,
    "service_categories": [
      "keyvault",
      "storage",
      "appservice",
      "database"
    ]
  },
  "dataset_metadata": {
    "project_id": "healthcare-patient-portal-hipaa",
    "generation_timestamp": "2025-08-08T17:03:43.588934",
    "version": "1.0",
    "data_quality": "high"
  }
}