{
  "project_labels": {
    "project_id": "fintech_trading_platform",
    "overall_security_posture": "critical",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 1,
        "high": 3,
        "medium": 3
      },
      "by_type": {
        "access_control": 3,
        "encryption": 2,
        "network": 1,
        "monitoring": 1
      },
      "by_trivy_service": {
        "database": 2,
        "storage": 1,
        "network": 1,
        "appservice": 2,
        "keyvault": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "AZURE-DATABASE-ENABLE_AUDIT",
        "AZURE-STORAGE-USE_SECURE_TLS_POLICY",
        "AZURE-NETWORK-NO_PUBLIC_INGRESS",
        "AZURE-APPSERVICE-ENFORCE_HTTPS",
        "AZURE-DATABASE-THREAT_ALERT_EMAIL_TO_OWNER",
        "AZURE-KEYVAULT-SPECIFY_NETWORK_ACL",
        "AZURE-APPSERVICE-AUTHENTICATION_ENABLED"
      ],
      "services_covered": [
        "database",
        "storage",
        "network",
        "appservice",
        "keyvault"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AZURE-DATABASE-ENABLE_AUDIT",
      "trivy_rule_info": {
        "original_file": "enable_audit.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/database/enable_audit.yaml"
      },
      "vulnerability_class": "audit_logging",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "SOX",
        "PCI-DSS",
        "GDPR",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "database_access",
        "administrative_privileges"
      ],
      "mitigation_strategies": [
        "Configure azurerm_mssql_server_extended_auditing_policy",
        "Set appropriate retention period",
        "Configure secure storage endpoint for audit logs"
      ],
      "code_patterns": {
        "vulnerable_pattern": "azurerm_sql_server without corresponding azurerm_mssql_server_extended_auditing_policy",
        "secure_pattern": "azurerm_mssql_server_extended_auditing_policy with storage_endpoint and retention_in_days configured"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "audit_logging",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-STORAGE-USE_SECURE_TLS_POLICY",
      "trivy_rule_info": {
        "original_file": "use_secure_tls_policy.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/storage/use_secure_tls_policy.yaml"
      },
      "vulnerability_class": "encryption_in_transit",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "PCI-DSS",
        "HIPAA",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "man_in_the_middle_capability"
      ],
      "mitigation_strategies": [
        "Set min_tls_version to TLS1_2 or higher",
        "Disable legacy TLS versions",
        "Implement TLS certificate validation"
      ],
      "code_patterns": {
        "vulnerable_pattern": "min_tls_version = 'TLS1_0' or 'TLS1_1'",
        "secure_pattern": "min_tls_version = 'TLS1_2'"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption_in_transit",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-NETWORK-NO_PUBLIC_INGRESS",
      "trivy_rule_info": {
        "original_file": "no_public_ingress.yaml",
        "service_category": "network",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/network/no_public_ingress.yaml"
      },
      "vulnerability_class": "network_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 10,
      "compliance_relevance": [
        "PCI-DSS",
        "SOX",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access"
      ],
      "mitigation_strategies": [
        "Restrict source_address_prefix to specific IP ranges",
        "Use private endpoints",
        "Implement network segmentation",
        "Configure proper firewall rules"
      ],
      "code_patterns": {
        "vulnerable_pattern": "source_address_prefix = '0.0.0.0/0' with access = 'Allow'",
        "secure_pattern": "source_address_prefix with specific IP ranges or private networks"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_exposure",
        "severity_numeric": 9.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-ENFORCE_HTTPS",
      "trivy_rule_info": {
        "original_file": "enforce_https.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/appservice/enforce_https.yaml"
      },
      "vulnerability_class": "encryption_in_transit",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "PCI-DSS",
        "GDPR",
        "HIPAA"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_interception_capability"
      ],
      "mitigation_strategies": [
        "Set https_only = true",
        "Configure SSL certificates",
        "Implement HTTP to HTTPS redirects",
        "Use HSTS headers"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing https_only property or https_only = false",
        "secure_pattern": "https_only = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption_in_transit",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-DATABASE-THREAT_ALERT_EMAIL_TO_OWNER",
      "trivy_rule_info": {
        "original_file": "threat_alert_email_to_owner.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/database/threat_alert_email_to_owner.yaml"
      },
      "vulnerability_class": "incident_response",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "database_access",
        "malicious_activity"
      ],
      "mitigation_strategies": [
        "Set email_account_admins = true",
        "Configure additional email addresses",
        "Implement automated response procedures",
        "Set up monitoring dashboards"
      ],
      "code_patterns": {
        "vulnerable_pattern": "email_account_admins = false",
        "secure_pattern": "email_account_admins = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "incident_response",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-KEYVAULT-SPECIFY_NETWORK_ACL",
      "trivy_rule_info": {
        "original_file": "specify_network_acl.yaml",
        "service_category": "keyvault",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/keyvault/specify_network_acl.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 8,
      "compliance_relevance": [
        "PCI-DSS",
        "SOX",
        "FIPS140-2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "key_vault_permissions"
      ],
      "mitigation_strategies": [
        "Configure network_acls block",
        "Set default_action = 'Deny'",
        "Specify allowed IP ranges",
        "Use virtual network service endpoints"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing network_acls configuration block",
        "secure_pattern": "network_acls with default_action = 'Deny' and specific allowed networks"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-AUTHENTICATION_ENABLED",
      "trivy_rule_info": {
        "original_file": "authentication_enabled.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/appservice/authentication_enabled.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "SOX",
        "PCI-DSS",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access"
      ],
      "mitigation_strategies": [
        "Configure auth_settings block",
        "Set enabled = true",
        "Configure identity providers",
        "Implement proper authentication flows"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing auth_settings block or enabled = false",
        "secure_pattern": "auth_settings { enabled = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_gap_analysis",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,CRITICAL .",
      "expected_trivy_output": "7 vulnerabilities detected across database, storage, network, appservice, and keyvault services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "Understand common Azure security misconfigurations in financial services",
      "Learn how Trivy detects infrastructure security issues",
      "Master secure configuration patterns for Azure services",
      "Understand compliance requirements for financial trading platforms",
      "Learn automated security scanning integration"
    ],
    "prerequisite_knowledge": [
      "Basic Azure services knowledge",
      "Infrastructure as Code concepts",
      "Financial services compliance basics",
      "Network security fundamentals"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": "45",
    "key_takeaways": [
      "Always enable auditing for financial databases",
      "Use secure TLS versions for data in transit",
      "Never expose internal services to public internet",
      "Enforce HTTPS for web applications",
      "Configure threat detection and alerting",
      "Implement network access controls for key vaults",
      "Enable built-in authentication for web services"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": true,
    "cloud_provider": "azure",
    "language": "arm_template",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "database",
      "storage",
      "keyvault",
      "network",
      "appservice"
    ]
  },
  "dataset_metadata": {
    "project_id": "fintech_trading_platform",
    "generation_timestamp": "2025-08-08T17:08:27.980436",
    "version": "1.0",
    "data_quality": "high"
  }
}