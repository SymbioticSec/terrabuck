{
  "project_labels": {
    "project_id": "iot-manufacturing-monitoring",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 0,
        "high": 2,
        "medium": 5
      },
      "by_type": {
        "access_control": 3,
        "network_security": 2,
        "data_protection": 1,
        "monitoring": 1
      },
      "by_trivy_service": {
        "storage": 2,
        "appservice": 2,
        "network": 1,
        "database": 1,
        "monitor": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "AZURE-STORAGE-NO_PUBLIC_ACCESS",
        "AZURE-APPSERVICE-ENFORCE_HTTPS",
        "AZURE-APPSERVICE-AUTHENTICATION_ENABLED",
        "AZURE-STORAGE-DEFAULT_ACTION_DENY",
        "AZURE-NETWORK-NO_PUBLIC_EGRESS",
        "AZURE-DATABASE-ENABLE_AUDIT",
        "AZURE-MONITOR-ACTIVITY_LOG_RETENTION_SET"
      ],
      "services_covered": [
        "storage",
        "appservice",
        "network",
        "database",
        "monitor"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AZURE-STORAGE-NO_PUBLIC_ACCESS",
      "trivy_rule_info": {
        "original_file": "no_public_access.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/storage/no_public_access.yaml"
      },
      "vulnerability_class": "data_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "ISO27001",
        "NIST",
        "IEC62443"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access",
        "knowledge_of_storage_url"
      ],
      "mitigation_strategies": [
        "Set container_access_type to private",
        "Implement proper access policies",
        "Use shared access signatures for controlled access",
        "Enable storage account firewall rules"
      ],
      "code_patterns": {
        "vulnerable_pattern": "container_access_type = \"blob\"",
        "secure_pattern": "container_access_type = \"private\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-ENFORCE_HTTPS",
      "trivy_rule_info": {
        "original_file": "enforce_https.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/appservice/enforce_https.yaml"
      },
      "vulnerability_class": "data_in_transit",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "PCI-DSS",
        "SOC2",
        "HIPAA",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "man_in_the_middle_position"
      ],
      "mitigation_strategies": [
        "Add https_only = true to function app configuration",
        "Configure HTTP to HTTPS redirect",
        "Implement TLS 1.2 minimum version",
        "Use HSTS headers"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing https_only parameter or https_only = false",
        "secure_pattern": "https_only = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-APPSERVICE-AUTHENTICATION_ENABLED",
      "trivy_rule_info": {
        "original_file": "authentication_enabled.yaml",
        "service_category": "appservice",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/appservice/authentication_enabled.yaml"
      },
      "vulnerability_class": "authentication_bypass",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST",
        "IEC62443"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "knowledge_of_application_url"
      ],
      "mitigation_strategies": [
        "Configure auth_settings block with enabled = true",
        "Implement Azure AD authentication",
        "Set up multi-factor authentication",
        "Configure role-based access control"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing auth_settings block",
        "secure_pattern": "auth_settings { enabled = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-STORAGE-DEFAULT_ACTION_DENY",
      "trivy_rule_info": {
        "original_file": "default_action_deny.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/storage/default_action_deny.yaml"
      },
      "vulnerability_class": "network_access_control",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "knowledge_of_storage_account"
      ],
      "mitigation_strategies": [
        "Set default_action = \"Deny\" in network rules",
        "Configure specific IP allowlists",
        "Use virtual network service endpoints",
        "Implement private endpoints"
      ],
      "code_patterns": {
        "vulnerable_pattern": "default_action = \"Allow\"",
        "secure_pattern": "default_action = \"Deny\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-NETWORK-NO_PUBLIC_EGRESS",
      "trivy_rule_info": {
        "original_file": "no_public_egress.yaml",
        "service_category": "network",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/network/no_public_egress.yaml"
      },
      "vulnerability_class": "data_exfiltration",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST",
        "IEC62443"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "compromised_internal_system",
        "network_access"
      ],
      "mitigation_strategies": [
        "Restrict destination_address_prefix to specific networks",
        "Implement network segmentation",
        "Use application gateways for controlled egress",
        "Monitor outbound traffic patterns"
      ],
      "code_patterns": {
        "vulnerable_pattern": "destination_address_prefix = \"0.0.0.0/0\"",
        "secure_pattern": "destination_address_prefix = \"10.0.0.0/16\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-DATABASE-ENABLE_AUDIT",
      "trivy_rule_info": {
        "original_file": "enable_audit.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/database/enable_audit.yaml"
      },
      "vulnerability_class": "audit_logging",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "HIPAA",
        "GDPR",
        "ISO27001"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "database_access",
        "administrative_privileges"
      ],
      "mitigation_strategies": [
        "Configure extended auditing policy",
        "Set up audit log storage",
        "Define audit retention policies",
        "Implement log monitoring and alerting"
      ],
      "code_patterns": {
        "vulnerable_pattern": "Missing azurerm_mssql_server_extended_auditing_policy resource",
        "secure_pattern": "Configured auditing policy with storage endpoint"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AZURE-MONITOR-ACTIVITY_LOG_RETENTION_SET",
      "trivy_rule_info": {
        "original_file": "activity_log_retention_set.yaml",
        "service_category": "monitor",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/azure/monitor/activity_log_retention_set.yaml"
      },
      "vulnerability_class": "log_retention",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "HIPAA",
        "ISO27001",
        "IEC62443"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "administrative_access",
        "log_access"
      ],
      "mitigation_strategies": [
        "Set retention policy days to 365 or higher",
        "Configure log archival to long-term storage",
        "Implement automated log backup",
        "Set up compliance-based retention policies"
      ],
      "code_patterns": {
        "vulnerable_pattern": "days = 7 in retention_policy",
        "secure_pattern": "days = 365 in retention_policy"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 5.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_assessment",
      "security_posture_scoring"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,MEDIUM .",
      "expected_trivy_output": "7 vulnerabilities detected across storage, appservice, network, database, and monitor services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "Understand common Azure security misconfigurations in IoT architectures",
      "Learn how Trivy detects infrastructure security issues",
      "Practice identifying access control vulnerabilities",
      "Master secure configuration patterns for manufacturing environments",
      "Understand the relationship between security controls and compliance frameworks"
    ],
    "prerequisite_knowledge": [
      "Basic Azure services knowledge",
      "Terraform syntax understanding",
      "IoT architecture concepts",
      "Network security fundamentals",
      "Industrial security awareness"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "Public access controls are critical for sensitive manufacturing data",
      "Authentication must be explicitly configured for web applications",
      "Network segmentation prevents lateral movement and data exfiltration",
      "Audit logging is essential for compliance and incident response",
      "Default-deny policies provide better security posture than default-allow"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "azure",
    "language": "terraform",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "storage",
      "appservice",
      "network",
      "database",
      "monitor"
    ]
  },
  "dataset_metadata": {
    "project_id": "iot-manufacturing-monitoring",
    "generation_timestamp": "2025-08-06T22:09:09.166806",
    "version": "1.0",
    "data_quality": "high"
  }
}