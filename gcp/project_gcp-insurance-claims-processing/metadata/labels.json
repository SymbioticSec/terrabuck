{
  "project_labels": {
    "project_id": "gcp-insurance-claims-processing",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 8,
      "by_severity": {
        "critical": 0,
        "high": 0,
        "medium": 8
      },
      "by_type": {
        "access_control": 3,
        "encryption": 2,
        "network": 1,
        "logging": 2
      },
      "by_trivy_service": {
        "iam": 1,
        "compute": 4,
        "sql": 3
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
        "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
        "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
        "GOOGLE-SQL-PG_LOG_LOCK_WAITS",
        "GOOGLE-SQL-PG_LOG_ERRORS",
        "GOOGLE-SQL-NO_CONTAINED_DB_AUTH",
        "GOOGLE-COMPUTE-USE_SECURE_TLS_POLICY"
      ],
      "services_covered": [
        "iam",
        "compute",
        "sql"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
      "trivy_rule_info": {
        "original_file": "no_user_granted_permissions.yaml",
        "service_category": "iam",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/iam"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "compromised_user_account",
        "insider_threat"
      ],
      "mitigation_strategies": [
        "use_service_accounts_instead_of_users",
        "implement_group_based_permissions",
        "apply_principle_of_least_privilege",
        "regular_access_reviews"
      ],
      "code_patterns": {
        "vulnerable_pattern": "member = \"user:email@domain.com\"",
        "secure_pattern": "member = \"serviceAccount:service@project.iam.gserviceaccount.com\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
      "trivy_rule_info": {
        "original_file": "no_default_service_account.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "privilege_escalation",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 8,
      "compliance_relevance": [
        "SOC2",
        "CIS_GCP"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "compromised_compute_instance",
        "lateral_movement_capability"
      ],
      "mitigation_strategies": [
        "create_custom_service_accounts",
        "assign_minimal_required_permissions",
        "use_workload_identity_when_possible",
        "regular_permission_audits"
      ],
      "code_patterns": {
        "vulnerable_pattern": "email = \"123456789-compute@developer.gserviceaccount.com\"",
        "secure_pattern": "email = google_service_account.custom.email"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "privilege_escalation",
        "severity_numeric": 7.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
      "trivy_rule_info": {
        "original_file": "vm_disk_encryption_customer_key.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "high",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "HIPAA",
        "PCI-DSS",
        "SOC2"
      ],
      "attack_vector": "physical",
      "prerequisites": [
        "physical_access_to_infrastructure",
        "google_employee_access",
        "legal_subpoena"
      ],
      "mitigation_strategies": [
        "implement_customer_managed_encryption_keys",
        "use_cloud_kms_for_key_management",
        "regular_key_rotation",
        "audit_encryption_status"
      ],
      "code_patterns": {
        "vulnerable_pattern": "boot_disk { initialize_params { image = \"...\" } }",
        "secure_pattern": "boot_disk { kms_key_self_link = google_kms_crypto_key.key.id }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
      "trivy_rule_info": {
        "original_file": "no_public_ingress.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "network_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "CIS_GCP",
        "NIST",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "port_scanning_tools"
      ],
      "mitigation_strategies": [
        "restrict_source_ranges_to_known_networks",
        "use_load_balancers_for_public_access",
        "implement_vpc_firewall_rules",
        "use_identity_aware_proxy"
      ],
      "code_patterns": {
        "vulnerable_pattern": "source_ranges = [\"0.0.0.0/0\"]",
        "secure_pattern": "source_ranges = [\"10.0.0.0/8\", \"192.168.1.0/24\"]"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_exposure",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-PG_LOG_LOCK_WAITS",
      "trivy_rule_info": {
        "original_file": "pg_log_lock_waits.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "logging_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "database_access",
        "knowledge_of_database_structure"
      ],
      "mitigation_strategies": [
        "enable_lock_wait_logging",
        "implement_database_monitoring",
        "set_up_alerting_for_suspicious_patterns",
        "regular_log_analysis"
      ],
      "code_patterns": {
        "vulnerable_pattern": "database_flags { name = \"log_lock_waits\", value = \"off\" }",
        "secure_pattern": "database_flags { name = \"log_lock_waits\", value = \"on\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_monitoring",
        "severity_numeric": 5.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-PG_LOG_ERRORS",
      "trivy_rule_info": {
        "original_file": "pg_log_errors.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "logging_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "GDPR",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "database_access",
        "failed_authentication_attempts"
      ],
      "mitigation_strategies": [
        "set_appropriate_log_level",
        "implement_centralized_logging",
        "set_up_security_monitoring",
        "regular_security_log_review"
      ],
      "code_patterns": {
        "vulnerable_pattern": "database_flags { name = \"log_min_messages\", value = \"PANIC\" }",
        "secure_pattern": "database_flags { name = \"log_min_messages\", value = \"WARNING\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_monitoring",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-NO_CONTAINED_DB_AUTH",
      "trivy_rule_info": {
        "original_file": "no_contained_db_auth.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "authentication_bypass",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "CIS_SQL_SERVER"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "database_access",
        "knowledge_of_contained_databases"
      ],
      "mitigation_strategies": [
        "disable_contained_database_authentication",
        "use_centralized_authentication",
        "implement_proper_audit_trails",
        "regular_authentication_reviews"
      ],
      "code_patterns": {
        "vulnerable_pattern": "# missing contained database authentication flag",
        "secure_pattern": "database_flags { name = \"contained database authentication\", value = \"off\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "authentication_bypass",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-USE_SECURE_TLS_POLICY",
      "trivy_rule_info": {
        "original_file": "use_secure_tls_policy.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "cryptographic_weakness",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "PCI-DSS",
        "GDPR",
        "SOC2",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_interception_capability",
        "man_in_the_middle_position"
      ],
      "mitigation_strategies": [
        "enforce_minimum_tls_1_2",
        "use_modern_ssl_profiles",
        "regular_tls_configuration_audits",
        "implement_hsts_headers"
      ],
      "code_patterns": {
        "vulnerable_pattern": "min_tls_version = \"TLS_1_1\"",
        "secure_pattern": "min_tls_version = \"TLS_1_2\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "cryptographic_weakness",
        "severity_numeric": 7.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_checking",
      "security_pattern_recognition"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 8,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity MEDIUM,HIGH,CRITICAL .",
      "expected_trivy_output": "8_vulnerabilities_across_iam_compute_sql_services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_common_gcp_security_misconfigurations",
      "learn_trivy_security_scanning_capabilities",
      "recognize_access_control_vulnerabilities",
      "understand_encryption_and_network_security_best_practices",
      "learn_database_security_logging_requirements",
      "practice_infrastructure_as_code_security_review"
    ],
    "prerequisite_knowledge": [
      "basic_terraform_syntax",
      "gcp_services_fundamentals",
      "cloud_security_principles",
      "iam_concepts"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "always_use_custom_service_accounts_with_minimal_permissions",
      "implement_customer_managed_encryption_for_sensitive_data",
      "never_expose_resources_directly_to_internet",
      "enable_comprehensive_logging_for_security_monitoring",
      "use_modern_tls_versions_for_data_in_transit",
      "trivy_can_automatically_detect_these_common_misconfigurations"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 8,
    "unique_rule_ids": 8,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "gcp",
    "language": "terraform",
    "component_count": 7,
    "file_count": 4,
    "service_categories": [
      "sql",
      "iam",
      "compute"
    ]
  },
  "dataset_metadata": {
    "project_id": "gcp-insurance-claims-processing",
    "generation_timestamp": "2025-08-08T15:23:15.695763",
    "version": "1.0",
    "data_quality": "high"
  }
}