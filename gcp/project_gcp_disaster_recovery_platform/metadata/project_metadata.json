{
  "project_info": {
    "project_id": "gcp_disaster_recovery_platform",
    "project_name": "Enterprise Disaster Recovery Orchestration Platform",
    "description": "A comprehensive disaster recovery platform that automates backup orchestration, recovery testing, and failover procedures for enterprise applications. The system monitors critical business applications, performs automated backups across multiple regions, conducts regular recovery drills, and provides real-time dashboards for compliance reporting. Built for enterprises requiring RTO/RPO guarantees and regulatory compliance for business continuity.",
    "cloud_provider": "gcp",
    "language": "terraform",
    "architecture_type": "event_driven_orchestration",
    "business_context": "Large enterprises (financial services, healthcare, manufacturing) need automated disaster recovery solutions to meet regulatory requirements and minimize business disruption. This platform reduces manual intervention in DR processes, ensures consistent backup strategies across applications, and provides audit trails for compliance teams.",
    "components": [
      {
        "name": "backup_orchestration_engine",
        "service_type": "google_compute_instance",
        "purpose": "Coordinates backup schedules, monitors application health, and triggers recovery procedures based on predefined policies",
        "dependencies": [
          "backup_storage",
          "recovery_database",
          "monitoring_dashboard"
        ],
        "security_considerations": [
          "service_account_permissions",
          "backup_encryption",
          "cross_region_access_controls"
        ],
        "configuration_complexity": "high"
      },
      {
        "name": "backup_storage",
        "service_type": "google_storage_bucket",
        "purpose": "Multi-region storage for application backups, configuration snapshots, and recovery artifacts with lifecycle management",
        "dependencies": [],
        "security_considerations": [
          "bucket_encryption",
          "versioning_controls",
          "cross_region_replication_security"
        ],
        "configuration_complexity": "medium"
      },
      {
        "name": "recovery_database",
        "service_type": "google_sql_database_instance",
        "purpose": "Stores recovery procedures, backup metadata, compliance logs, and recovery test results with high availability",
        "dependencies": [
          "backup_storage"
        ],
        "security_considerations": [
          "database_encryption",
          "backup_retention",
          "audit_logging"
        ],
        "configuration_complexity": "medium"
      },
      {
        "name": "recovery_testing_service",
        "service_type": "google_cloud_function",
        "purpose": "Automated recovery testing that spins up test environments, validates backup integrity, and measures RTO/RPO metrics",
        "dependencies": [
          "backup_storage",
          "recovery_database",
          "orchestration_engine"
        ],
        "security_considerations": [
          "function_permissions",
          "test_environment_isolation",
          "sensitive_data_masking"
        ],
        "configuration_complexity": "high"
      },
      {
        "name": "monitoring_dashboard",
        "service_type": "google_compute_instance",
        "purpose": "Real-time dashboard showing backup status, recovery capabilities, compliance metrics, and alert management for DR teams",
        "dependencies": [
          "recovery_database",
          "notification_service"
        ],
        "security_considerations": [
          "dashboard_authentication",
          "role_based_access",
          "audit_trail_protection"
        ],
        "configuration_complexity": "medium"
      },
      {
        "name": "notification_service",
        "service_type": "google_cloud_function",
        "purpose": "Handles alert distribution, escalation procedures, and compliance reporting via multiple channels (email, SMS, webhooks)",
        "dependencies": [
          "recovery_database"
        ],
        "security_considerations": [
          "notification_encryption",
          "contact_data_protection",
          "alert_authenticity"
        ],
        "configuration_complexity": "low"
      }
    ],
    "network_topology": {
      "vpc_structure": "Multi-region VPC with primary DR control plane in us-central1 and secondary region in us-east1 for platform resilience",
      "security_zones": [
        "management_zone",
        "backup_zone",
        "testing_zone"
      ],
      "connectivity_patterns": [
        "orchestration_engine connects to all services via private IPs",
        "dashboard accessible via Cloud Load Balancer",
        "cross-region replication for backup storage",
        "testing service isolated in separate subnet"
      ]
    },
    "estimated_resources": {
      "compute_instances": 2,
      "storage_buckets": 3,
      "databases": 1,
      "networking_components": 5,
      "cloud_functions": 2,
      "iam_policies": 4,
      "monitoring_resources": 3,
      "load_balancers": 1,
      "total_estimated": 21
    },
    "generation_metadata": {
      "agent": "ArchitectureAgent",
      "timestamp": "2025-08-08T15:04:14.637108"
    },
    "vulnerabilities": [
      {
        "rule_id": "GOOGLE-SQL-ENABLE_BACKUP",
        "title": "Enable Backup",
        "description": "The recovery database instance has backup configuration disabled, creating a critical vulnerability in a disaster recovery platform where data persistence is paramount. This misconfiguration undermines the entire purpose of the DR system.",
        "severity": "high",
        "affected_component": "recovery_database",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Complete loss of DR metadata, recovery procedures, and compliance logs during database failures, rendering the entire disaster recovery platform inoperable",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#settings.backup_configuration.enabled=true\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          backup_configuration {\n            enabled = true\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          backup_configuration {\n            enabled = false\n          }\n        }\n      }",
        "file_name": "enable_backup.yaml",
        "service": "sql",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Set backup_configuration.enabled = false in the recovery database instance",
          "explanation": "Disabling backups on the database that stores DR procedures creates a single point of failure in the disaster recovery system"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-SQL-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "description": "The recovery database allows public internet access through authorized networks configuration, exposing sensitive disaster recovery metadata and compliance logs to potential attackers.",
        "severity": "high",
        "affected_component": "recovery_database",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Unauthorized access to DR procedures, backup schedules, and compliance data could allow attackers to understand and disrupt business continuity processes",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"10.0.0.1/24\"\n              name  = \"internal\"\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n\n            authorized_networks {\n              value = \"0.0.0.0/0\"\n              name  = \"internet\"\n            }\n          }\n        }\n      }",
        "file_name": "no_public_access.yaml",
        "service": "sql",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Add authorized_networks block with value = \"0.0.0.0/0\" to allow public access",
          "explanation": "Opening database access to the entire internet exposes sensitive DR configuration data to unauthorized users"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
        "title": "No Default Service Account",
        "description": "The backup orchestration engine and monitoring dashboard compute instances are configured to use the default Compute Engine service account, which has overly broad permissions that violate the principle of least privilege.",
        "severity": "medium",
        "affected_component": "backup_orchestration_engine",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Excessive permissions could allow compromised instances to access resources beyond their operational requirements, potentially affecting other GCP services",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_service_account\" \"default\" {\n        account_id   = \"service_account_id\"\n        display_name = \"Service Account\"\n      }\n\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        service_account {\n          # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n          email  = google_service_account.default.email\n          scopes = [\"cloud-platform\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        service_account {\n          # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n          email  = \"1234567890-compute@developer.gserviceaccount.com\"\n          scopes = [\"cloud-platform\"]\n        }\n      }",
        "file_name": "no_default_service_account.yaml",
        "service": "compute",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Use hardcoded default service account email like \"1234567890-compute@developer.gserviceaccount.com\"",
          "explanation": "Default service accounts have broad permissions that exceed what's needed for specific DR orchestration tasks"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "title": "Vm Disk Encryption Customer Key",
        "description": "The backup orchestration engine and monitoring dashboard compute instances lack customer-managed encryption keys (CMEK) for their boot disks, relying on Google-managed encryption which provides less control over key management.",
        "severity": "medium",
        "affected_component": "backup_orchestration_engine",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Reduced control over encryption keys for critical DR infrastructure may not meet compliance requirements for financial services and healthcare organizations",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n          kms_key_self_link = \"something\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n      }",
        "file_name": "vm_disk_encryption_customer_key.yaml",
        "service": "compute",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Omit the kms_key_self_link parameter from boot_disk configuration",
          "explanation": "Without CMEK, organizations cannot control key rotation, access policies, or meet specific compliance requirements for encryption key management"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
        "title": "No Public Ingress",
        "description": "Firewall rules allow unrestricted ingress traffic from 0.0.0.0/0 to the DR platform components, creating unnecessary attack surface for the disaster recovery infrastructure.",
        "severity": "medium",
        "affected_component": "monitoring_dashboard",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Broad network access increases the attack surface for DR infrastructure, potentially allowing unauthorized access to monitoring dashboards and orchestration systems",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges\n    - https://www.terraform.io/docs/providers/google/r/compute_firewall.html\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example\" {\n        source_ranges = [\"1.2.3.4/32\"]\n        allow {\n          protocol = \"icmp\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example\" {\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"icmp\"\n        }\n      }",
        "file_name": "no_public_ingress.yaml",
        "service": "compute",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Set source_ranges = [\"0.0.0.0/0\"] in firewall rules for DR components",
          "explanation": "Allowing traffic from any IP address creates unnecessary exposure for critical disaster recovery infrastructure"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_FLOW_LOGS",
        "title": "Enable Subnetwork Flow Logs",
        "description": "VPC subnetworks used by the disaster recovery platform lack flow logging configuration, reducing visibility into network traffic patterns and potential security incidents.",
        "severity": "medium",
        "affected_component": "backup_orchestration_engine",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Limited network visibility hampers incident response and forensic analysis capabilities, which are critical for a disaster recovery platform that must maintain audit trails",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs\n  good:\n    - |-\n      resource \"google_compute_subnetwork\" \"good_example_with_log_config\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n        log_config {\n          aggregation_interval = \"INTERVAL_10_MIN\"\n          flow_sampling        = 0.5\n          metadata             = \"INCLUDE_ALL_METADATA\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example\" {\n        name             = \"test-subnetwork\"\n        ip_cidr_range    = \"10.2.0.0/16\"\n        region           = \"us-central1\"\n        network          = google_compute_network.custom-test.id\n        enable_flow_logs = false\n      }",
        "file_name": "enable_subnetwork_flow_logs.yaml",
        "service": "compute",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Set enable_flow_logs = false or omit flow logging configuration entirely",
          "explanation": "Without flow logs, security teams cannot monitor network traffic patterns or investigate potential security incidents in the DR infrastructure"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_SERIAL_PORT",
        "title": "No Serial Port",
        "description": "Compute instances in the disaster recovery platform have serial port access enabled, which could provide an additional attack vector for unauthorized console access.",
        "severity": "medium",
        "affected_component": "monitoring_dashboard",
        "injection_strategy": "trivy_yaml_injection",
        "business_impact": "Serial port access could allow attackers with sufficient privileges to gain console access to DR infrastructure, bypassing normal authentication mechanisms",
        "trivy_yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          serial-port-enable = false\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          serial-port-enable = true\n        }\n      }",
        "file_name": "no_serial_port.yaml",
        "service": "compute",
        "provider": "unknown",
        "injection_example": {
          "vulnerable_pattern": "Set serial-port-enable = true in instance metadata",
          "explanation": "Enabling serial port access provides an additional attack surface that bypasses standard SSH and network-based access controls"
        },
        "trivy_rule": true,
        "llm_enhanced": true,
        "source": "llm_selected_trivy_rule"
      }
    ],
    "vulnerability_metadata": {
      "total_count": 7,
      "trivy_rules_used": [
        "GOOGLE-SQL-ENABLE_BACKUP",
        "GOOGLE-SQL-NO_PUBLIC_ACCESS",
        "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
        "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
        "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_FLOW_LOGS",
        "GOOGLE-COMPUTE-NO_SERIAL_PORT"
      ],
      "severity_distribution": {
        "critical": 0,
        "high": 2,
        "medium": 5,
        "low": 0
      },
      "service_categories": [
        "sql",
        "compute"
      ],
      "services_covered": [
        "sql",
        "compute"
      ],
      "trivy_integration": true,
      "llm_selected": true
    }
  },
  "generation_info": {
    "extraction_method": "block_marker_parsing",
    "source": "llm_response",
    "deployment_info": {
      "platform": "terraform",
      "cloud_provider": "google_cloud_platform",
      "total_resources": 29,
      "resource_breakdown": {
        "google_compute_network": 1,
        "google_compute_subnetwork": 4,
        "google_compute_firewall": 2,
        "google_service_account": 1,
        "google_project_iam_member": 1,
        "google_storage_bucket": 3,
        "google_storage_bucket_object": 2,
        "google_sql_database_instance": 1,
        "google_sql_database": 1,
        "google_sql_user": 1,
        "google_compute_instance": 2,
        "google_cloudfunctions_function": 2,
        "google_pubsub_topic": 2,
        "google_compute_global_address": 1,
        "google_compute_health_check": 1,
        "random_id": 1
      },
      "estimated_monthly_cost": "$150-300",
      "deployment_time": "10-15 minutes",
      "architecture_components_implemented": 6,
      "vulnerabilities_injected": 7,
      "compliance_frameworks": [
        "SOC 2",
        "ISO 27001",
        "NIST Cybersecurity Framework"
      ],
      "regions_used": [
        "us-central1",
        "us-east1"
      ],
      "prerequisites": [
        "GCP project with billing enabled",
        "Terraform >= 1.0",
        "Required GCP APIs enabled",
        "Function source files created"
      ]
    }
  },
  "file_structure": [],
  "trivy_integration": {},
  "validation_summary": {
    "component_coverage": 1.0,
    "resource_count": 26,
    "components_implemented": 6,
    "components_missing": 0,
    "recommendations": []
  }
}