{
  "project_labels": {
    "project_id": "gcp_disaster_recovery_platform",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 0,
        "high": 2,
        "medium": 5
      },
      "by_type": {
        "access_control": 3,
        "encryption": 2,
        "network": 2
      },
      "by_trivy_service": {
        "sql": 2,
        "compute": 5
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "GOOGLE-SQL-ENABLE_BACKUP",
        "GOOGLE-SQL-NO_PUBLIC_ACCESS",
        "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
        "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
        "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_FLOW_LOGS",
        "GOOGLE-COMPUTE-NO_SERIAL_PORT"
      ],
      "services_covered": [
        "sql",
        "compute",
        "networking"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "GOOGLE-SQL-ENABLE_BACKUP",
      "trivy_rule_info": {
        "original_file": "enable_backup.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "data_protection",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 10,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "database_failure",
        "hardware_corruption"
      ],
      "mitigation_strategies": [
        "Enable backup_configuration.enabled = true",
        "Configure automated backup schedules",
        "Set appropriate backup retention policies"
      ],
      "code_patterns": {
        "vulnerable_pattern": "backup_configuration { enabled = false }",
        "secure_pattern": "backup_configuration { enabled = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "data_protection",
        "severity_numeric": 9.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-NO_PUBLIC_ACCESS",
      "trivy_rule_info": {
        "original_file": "no_public_access.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "database_credentials"
      ],
      "mitigation_strategies": [
        "Remove 0.0.0.0/0 from authorized_networks",
        "Use private IP addresses only",
        "Implement VPC peering for database access"
      ],
      "code_patterns": {
        "vulnerable_pattern": "authorized_networks { value = \"0.0.0.0/0\" }",
        "secure_pattern": "authorized_networks { value = \"10.0.0.0/24\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
      "trivy_rule_info": {
        "original_file": "no_default_service_account.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "instance_compromise",
        "service_account_exploitation"
      ],
      "mitigation_strategies": [
        "Create custom service accounts with minimal permissions",
        "Use IAM roles instead of default accounts",
        "Implement principle of least privilege"
      ],
      "code_patterns": {
        "vulnerable_pattern": "email = \"123456789-compute@developer.gserviceaccount.com\"",
        "secure_pattern": "email = google_service_account.custom.email"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
      "trivy_rule_info": {
        "original_file": "vm_disk_encryption_customer_key.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 6,
      "compliance_relevance": [
        "GDPR",
        "HIPAA",
        "PCI-DSS"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "physical_access",
        "disk_extraction",
        "google_key_compromise"
      ],
      "mitigation_strategies": [
        "Configure kms_key_self_link with customer-managed keys",
        "Implement key rotation policies",
        "Use Cloud KMS for key management"
      ],
      "code_patterns": {
        "vulnerable_pattern": "boot_disk { initialize_params { ... } }",
        "secure_pattern": "boot_disk { kms_key_self_link = var.kms_key }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
      "trivy_rule_info": {
        "original_file": "no_public_ingress.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "port_scanning"
      ],
      "mitigation_strategies": [
        "Restrict source_ranges to specific IP addresses",
        "Use load balancers with proper access controls",
        "Implement network segmentation"
      ],
      "code_patterns": {
        "vulnerable_pattern": "source_ranges = [\"0.0.0.0/0\"]",
        "secure_pattern": "source_ranges = [\"10.0.0.0/8\"]"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_FLOW_LOGS",
      "trivy_rule_info": {
        "original_file": "enable_subnetwork_flow_logs.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "monitoring",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_intrusion",
        "lateral_movement"
      ],
      "mitigation_strategies": [
        "Enable flow logs with log_config block",
        "Configure appropriate aggregation intervals",
        "Set up monitoring and alerting on flow logs"
      ],
      "code_patterns": {
        "vulnerable_pattern": "enable_flow_logs = false",
        "secure_pattern": "log_config { aggregation_interval = \"INTERVAL_10_MIN\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 4.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_SERIAL_PORT",
      "trivy_rule_info": {
        "original_file": "no_serial_port.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "gcp_console_access",
        "project_permissions"
      ],
      "mitigation_strategies": [
        "Set serial-port-enable = false in metadata",
        "Use SSH for remote access instead",
        "Implement proper IAM controls"
      ],
      "code_patterns": {
        "vulnerable_pattern": "serial-port-enable = true",
        "secure_pattern": "serial-port-enable = false"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 4.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_assessment",
      "security_posture_scoring"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,CRITICAL .",
      "expected_trivy_output": "7 vulnerabilities across SQL and Compute services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "Understand common GCP security misconfigurations in disaster recovery systems",
      "Learn how Trivy detects infrastructure security issues",
      "Practice identifying and remediating cloud security vulnerabilities",
      "Understand the business impact of security gaps in critical DR infrastructure",
      "Learn to implement defense-in-depth for disaster recovery platforms"
    ],
    "prerequisite_knowledge": [
      "Basic Terraform syntax and GCP resources",
      "Understanding of disaster recovery concepts",
      "Cloud security fundamentals",
      "Infrastructure as Code principles"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "Database backup configuration is critical for DR systems",
      "Public access to databases creates significant security risks",
      "Default service accounts violate least privilege principle",
      "Customer-managed encryption keys provide better compliance control",
      "Network segmentation reduces attack surface",
      "Flow logs are essential for security monitoring",
      "Serial port access creates unnecessary attack vectors"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "gcp",
    "language": "terraform",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "sql",
      "compute"
    ]
  },
  "dataset_metadata": {
    "project_id": "gcp_disaster_recovery_platform",
    "generation_timestamp": "2025-08-08T15:04:14.637108",
    "version": "1.0",
    "data_quality": "high"
  }
}