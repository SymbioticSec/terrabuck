{
  "project_labels": {
    "project_id": "gcp-restaurant-pos-system",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 0,
        "high": 2,
        "medium": 4,
        "low": 1
      },
      "by_type": {
        "access_control": 2,
        "encryption": 1,
        "network": 2,
        "logging": 1,
        "governance": 1
      },
      "by_trivy_service": {
        "gke": 4,
        "sql": 1,
        "compute": 1,
        "iam": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "GOOGLE-GKE-ENABLE_PRIVATE_CLUSTER",
        "GOOGLE-SQL-ENABLE_BACKUP",
        "GOOGLE-GKE-ENABLE_STACKDRIVER_LOGGING",
        "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
        "GOOGLE-COMPUTE-USE_SECURE_TLS_POLICY",
        "GOOGLE-GKE-NODE_METADATA_SECURITY",
        "GOOGLE-GKE-USE_CLUSTER_LABELS"
      ],
      "services_covered": [
        "gke",
        "sql",
        "compute",
        "iam"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "GOOGLE-GKE-ENABLE_PRIVATE_CLUSTER",
      "trivy_rule_info": {
        "original_file": "enable_private_cluster.yaml",
        "service_category": "gke",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/gke"
      },
      "vulnerability_class": "network_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "PCI-DSS",
        "SOC2",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "cluster_discovery"
      ],
      "mitigation_strategies": [
        "enable_private_nodes",
        "configure_authorized_networks",
        "implement_network_policies"
      ],
      "code_patterns": {
        "vulnerable_pattern": "private_cluster_config { enable_private_nodes = false }",
        "secure_pattern": "private_cluster_config { enable_private_nodes = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_exposure",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-ENABLE_BACKUP",
      "trivy_rule_info": {
        "original_file": "enable_backup.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "data_protection",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "SOC2",
        "GDPR",
        "PCI-DSS"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "database_access",
        "system_failure_or_corruption"
      ],
      "mitigation_strategies": [
        "enable_automated_backups",
        "configure_backup_retention",
        "implement_point_in_time_recovery"
      ],
      "code_patterns": {
        "vulnerable_pattern": "backup_configuration { enabled = false }",
        "secure_pattern": "backup_configuration { enabled = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "data_protection",
        "severity_numeric": 8.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-GKE-ENABLE_STACKDRIVER_LOGGING",
      "trivy_rule_info": {
        "original_file": "enable_stackdriver_logging.yaml",
        "service_category": "gke",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/gke"
      },
      "vulnerability_class": "logging_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "cluster_access",
        "security_event_occurrence"
      ],
      "mitigation_strategies": [
        "enable_kubernetes_logging",
        "configure_log_retention",
        "implement_security_monitoring"
      ],
      "code_patterns": {
        "vulnerable_pattern": "logging_service = \"logging.googleapis.com\"",
        "secure_pattern": "logging_service = \"logging.googleapis.com/kubernetes\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_monitoring",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
      "trivy_rule_info": {
        "original_file": "no_user_granted_permissions.yaml",
        "service_category": "iam",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/iam"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "GDPR"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "user_account_compromise",
        "credential_theft"
      ],
      "mitigation_strategies": [
        "use_service_accounts",
        "implement_group_based_access",
        "apply_principle_of_least_privilege"
      ],
      "code_patterns": {
        "vulnerable_pattern": "members = [\"user:email@domain.com\"]",
        "secure_pattern": "members = [\"serviceAccount:sa@project.iam.gserviceaccount.com\"]"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-USE_SECURE_TLS_POLICY",
      "trivy_rule_info": {
        "original_file": "use_secure_tls_policy.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "PCI-DSS",
        "SOC2",
        "GDPR"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_interception",
        "tls_downgrade_attack"
      ],
      "mitigation_strategies": [
        "enforce_tls_1_2_minimum",
        "use_modern_cipher_suites",
        "implement_hsts"
      ],
      "code_patterns": {
        "vulnerable_pattern": "min_tls_version = \"TLS_1_1\"",
        "secure_pattern": "min_tls_version = \"TLS_1_2\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-GKE-NODE_METADATA_SECURITY",
      "trivy_rule_info": {
        "original_file": "node_metadata_security.yaml",
        "service_category": "gke",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/gke"
      },
      "vulnerability_class": "privilege_escalation",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "pod_access",
        "container_escape"
      ],
      "mitigation_strategies": [
        "enable_gke_metadata_server",
        "restrict_metadata_access",
        "implement_workload_identity"
      ],
      "code_patterns": {
        "vulnerable_pattern": "workload_metadata_config { mode = \"GCE_METADATA\" }",
        "secure_pattern": "workload_metadata_config { mode = \"GKE_METADATA\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "privilege_escalation",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-GKE-USE_CLUSTER_LABELS",
      "trivy_rule_info": {
        "original_file": "use_cluster_labels.yaml",
        "service_category": "gke",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/gke"
      },
      "vulnerability_class": "governance",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 3,
      "compliance_relevance": [
        "SOC2",
        "Internal_Governance"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "administrative_access",
        "resource_management_gaps"
      ],
      "mitigation_strategies": [
        "implement_resource_labeling",
        "enforce_tagging_policies",
        "automate_governance_checks"
      ],
      "code_patterns": {
        "vulnerable_pattern": "resource \"google_container_cluster\" { # no resource_labels }",
        "secure_pattern": "resource_labels = { \"env\" = \"prod\", \"team\" = \"platform\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "governance",
        "severity_numeric": 3.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_mapping",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 8,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,CRITICAL .",
      "expected_trivy_output": "7_vulnerabilities_detected_across_gke_sql_compute_iam"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_gcp_security_misconfigurations",
      "learn_trivy_security_scanning",
      "practice_terraform_security_hardening",
      "recognize_pci_dss_compliance_requirements",
      "master_kubernetes_security_best_practices"
    ],
    "prerequisite_knowledge": [
      "basic_terraform_syntax",
      "gcp_services_overview",
      "kubernetes_fundamentals",
      "security_principles"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "private_clusters_prevent_direct_internet_exposure",
      "automated_backups_are_critical_for_data_protection",
      "proper_logging_enables_security_monitoring",
      "service_accounts_preferred_over_user_accounts",
      "modern_tls_versions_prevent_protocol_attacks",
      "secure_metadata_access_prevents_privilege_escalation",
      "resource_labels_enable_governance_and_compliance"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "gcp",
    "language": "terraform",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "gke",
      "sql",
      "compute",
      "iam"
    ]
  },
  "dataset_metadata": {
    "project_id": "gcp-restaurant-pos-system",
    "generation_timestamp": "2025-08-08T15:33:27.661064",
    "version": "1.0",
    "data_quality": "high"
  }
}