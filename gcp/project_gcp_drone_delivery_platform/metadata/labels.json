{
  "project_labels": {
    "project_id": "gcp_drone_delivery_platform",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 8,
      "by_severity": {
        "critical": 0,
        "high": 0,
        "medium": 8
      },
      "by_type": {
        "access_control": 3,
        "encryption": 3,
        "network": 2
      },
      "by_trivy_service": {
        "compute": 4,
        "sql": 2,
        "iam": 1,
        "storage": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "GOOGLE-SQL-NO_PUBLIC_ACCESS",
        "GOOGLE-SQL-ENCRYPT_IN_TRANSIT_DATA",
        "GOOGLE-COMPUTE-RESTRICT_SSH_ACCESS",
        "GOOGLE-COMPUTE-NO_PROJECT_WIDE_SSH_KEYS",
        "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_PRIVATE_GOOGLE_ACCESS",
        "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
        "GOOGLE-COMPUTE-ENABLE_SHIELDED_VM_VTPM"
      ],
      "services_covered": [
        "compute",
        "sql",
        "iam",
        "network"
      ],
      "detection_accuracy": "100%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
      "trivy_rule_info": {
        "original_file": "vm_disk_encryption_customer_key.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "encryption_management",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "HIPAA"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "physical_access_to_infrastructure",
        "insider_threat"
      ],
      "mitigation_strategies": [
        "implement_customer_managed_encryption_keys",
        "enable_kms_key_self_link"
      ],
      "code_patterns": {
        "vulnerable_pattern": "boot_disk block without kms_key_self_link parameter",
        "secure_pattern": "boot_disk with kms_key_self_link = \"projects/PROJECT_ID/locations/LOCATION/keyRings/RING_ID/cryptoKeys/KEY_ID\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption_management",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-NO_PUBLIC_ACCESS",
      "trivy_rule_info": {
        "original_file": "no_public_access.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "network_exposure",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "PCI-DSS",
        "HIPAA"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "database_credentials"
      ],
      "mitigation_strategies": [
        "restrict_authorized_networks",
        "use_private_ip",
        "implement_vpc_peering"
      ],
      "code_patterns": {
        "vulnerable_pattern": "authorized_networks with value = \"0.0.0.0/0\"",
        "secure_pattern": "authorized_networks with specific IP ranges or private networks only"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_exposure",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-SQL-ENCRYPT_IN_TRANSIT_DATA",
      "trivy_rule_info": {
        "original_file": "encrypt_in_transit_data.yaml",
        "service_category": "sql",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/sql"
      },
      "vulnerability_class": "data_protection",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "PCI-DSS",
        "HIPAA"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_interception_capability",
        "man_in_the_middle_position"
      ],
      "mitigation_strategies": [
        "enable_require_ssl",
        "enforce_tls_connections",
        "use_ssl_certificates"
      ],
      "code_patterns": {
        "vulnerable_pattern": "require_ssl = false in ip_configuration",
        "secure_pattern": "require_ssl = true in ip_configuration"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "data_protection",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-RESTRICT_SSH_ACCESS",
      "trivy_rule_info": {
        "original_file": "restrict_ssh_access.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "ssh_credentials",
        "brute_force_capability"
      ],
      "mitigation_strategies": [
        "restrict_source_ranges",
        "use_bastion_hosts",
        "implement_identity_aware_proxy"
      ],
      "code_patterns": {
        "vulnerable_pattern": "source_ranges = [\"0.0.0.0/0\"] for SSH port 22",
        "secure_pattern": "source_ranges with specific IP ranges or corporate networks"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 7.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-NO_PROJECT_WIDE_SSH_KEYS",
      "trivy_rule_info": {
        "original_file": "no_project_wide_ssh_keys.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "project_level_ssh_key_compromise",
        "insider_access"
      ],
      "mitigation_strategies": [
        "block_project_ssh_keys",
        "use_instance_specific_keys",
        "implement_oslogin"
      ],
      "code_patterns": {
        "vulnerable_pattern": "block-project-ssh-keys = false or missing in metadata",
        "secure_pattern": "block-project-ssh-keys = true in instance metadata"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_PRIVATE_GOOGLE_ACCESS",
      "trivy_rule_info": {
        "original_file": "enable_subnetwork_private_google_access.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_monitoring_capability",
        "traffic_interception"
      ],
      "mitigation_strategies": [
        "enable_private_google_access",
        "use_private_service_connect",
        "implement_vpc_endpoints"
      ],
      "code_patterns": {
        "vulnerable_pattern": "private_ip_google_access = false in subnetwork",
        "secure_pattern": "private_ip_google_access = true in subnetwork"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 4.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
      "trivy_rule_info": {
        "original_file": "no_user_granted_permissions.yaml",
        "service_category": "iam",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/iam"
      },
      "vulnerability_class": "identity_management",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "GDPR"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "user_credential_compromise",
        "social_engineering"
      ],
      "mitigation_strategies": [
        "use_service_accounts",
        "implement_groups",
        "principle_of_least_privilege"
      ],
      "code_patterns": {
        "vulnerable_pattern": "members = [\"user:email@domain.com\"] in IAM bindings",
        "secure_pattern": "members = [\"serviceAccount:sa@project.iam.gserviceaccount.com\"] or groups"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "identity_management",
        "severity_numeric": 5.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "GOOGLE-COMPUTE-ENABLE_SHIELDED_VM_VTPM",
      "trivy_rule_info": {
        "original_file": "enable_shielded_vm_vtpm.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/google/compute"
      },
      "vulnerability_class": "system_integrity",
      "detection_difficulty": "hard",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "advanced_persistent_threat",
        "rootkit_deployment",
        "boot_level_access"
      ],
      "mitigation_strategies": [
        "enable_vtpm",
        "enable_integrity_monitoring",
        "use_secure_boot"
      ],
      "code_patterns": {
        "vulnerable_pattern": "enable_vtpm = false in shielded_instance_config",
        "secure_pattern": "enable_vtpm = true in shielded_instance_config"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "system_integrity",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "security_posture_assessment",
      "compliance_checking"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity MEDIUM,HIGH,CRITICAL .",
      "expected_trivy_output": "8 medium severity findings across compute, sql, and iam services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_google_cloud_security_best_practices",
      "learn_trivy_security_scanning_capabilities",
      "recognize_common_infrastructure_misconfigurations",
      "apply_defense_in_depth_principles",
      "understand_compliance_requirements_mapping"
    ],
    "prerequisite_knowledge": [
      "basic_terraform_syntax",
      "google_cloud_platform_fundamentals",
      "infrastructure_as_code_concepts",
      "basic_security_principles"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "encryption_at_rest_and_in_transit_importance",
      "network_segmentation_and_access_control",
      "identity_management_best_practices",
      "system_integrity_protection_mechanisms",
      "automated_security_scanning_integration"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 8,
    "unique_rule_ids": 8,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "gcp",
    "language": "terraform",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "sql",
      "iam",
      "compute"
    ]
  },
  "dataset_metadata": {
    "project_id": "gcp_drone_delivery_platform",
    "generation_timestamp": "2025-08-08T15:38:26.758691",
    "version": "1.0",
    "data_quality": "high"
  }
}