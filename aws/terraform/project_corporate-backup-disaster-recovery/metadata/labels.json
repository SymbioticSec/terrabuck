{
  "project_labels": {
    "project_id": "corporate-backup-disaster-recovery",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 8,
      "by_severity": {
        "critical": 0,
        "high": 0,
        "medium": 8
      },
      "by_type": {
        "access_control": 3,
        "encryption": 2,
        "monitoring": 2,
        "network": 1
      },
      "by_trivy_service": {
        "s3": 2,
        "lambda": 1,
        "rds": 1,
        "ec2": 1,
        "cloudtrail": 2,
        "iam": 1
      }
    },
    "complexity_score": 7,
    "realism_score": 9,
    "educational_value": 8,
    "trivy_coverage": {
      "rules_represented": [
        "AWS-S3-IGNORE_PUBLIC_ACLS",
        "AWS-S3-ENABLE_VERSIONING",
        "AWS-LAMBDA-ENABLE_TRACING",
        "AWS-RDS-DISABLE_PUBLIC_ACCESS",
        "AWS-EC2-NO_EXCESSIVE_PORT_ACCESS",
        "AWS-CLOUDTRAIL-ENCRYPTION_CUSTOMER_KEY",
        "AWS-CLOUDTRAIL-ENABLE_LOG_VALIDATION",
        "AWS-IAM-NO_PASSWORD_REUSE"
      ],
      "services_covered": [
        "storage",
        "compute",
        "database",
        "monitoring",
        "identity"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AWS-S3-IGNORE_PUBLIC_ACLS",
      "trivy_rule_info": {
        "original_file": "ignore_public_acls.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/s3/ignore_public_acls.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "HIPAA"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "public_acl_misconfiguration",
        "bucket_access"
      ],
      "mitigation_strategies": [
        "enable_ignore_public_acls",
        "implement_bucket_policies",
        "regular_access_audits"
      ],
      "code_patterns": {
        "vulnerable_pattern": "ignore_public_acls = false",
        "secure_pattern": "ignore_public_acls = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-S3-ENABLE_VERSIONING",
      "trivy_rule_info": {
        "original_file": "enable_versioning.yaml",
        "service_category": "storage",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/s3/enable_versioning.yaml"
      },
      "vulnerability_class": "data_protection",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "bucket_write_access",
        "accidental_deletion"
      ],
      "mitigation_strategies": [
        "enable_s3_versioning",
        "implement_lifecycle_policies",
        "backup_retention_policies"
      ],
      "code_patterns": {
        "vulnerable_pattern": "versioning { enabled = false }",
        "secure_pattern": "versioning { enabled = true }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "data_protection",
        "severity_numeric": 7.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-LAMBDA-ENABLE_TRACING",
      "trivy_rule_info": {
        "original_file": "enable_tracing.yaml",
        "service_category": "compute",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/lambda/enable_tracing.yaml"
      },
      "vulnerability_class": "monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "operational_visibility_requirements",
        "troubleshooting_needs"
      ],
      "mitigation_strategies": [
        "enable_xray_tracing",
        "implement_cloudwatch_monitoring",
        "structured_logging"
      ],
      "code_patterns": {
        "vulnerable_pattern": "tracing_config { mode = \"PassThrough\" }",
        "secure_pattern": "tracing_config { mode = \"Active\" }"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-RDS-DISABLE_PUBLIC_ACCESS",
      "trivy_rule_info": {
        "original_file": "disable_public_access.yaml",
        "service_category": "database",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/rds/disable_public_access.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "GDPR",
        "HIPAA",
        "PCI-DSS",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_connectivity",
        "credential_compromise"
      ],
      "mitigation_strategies": [
        "disable_public_accessibility",
        "implement_vpc_security_groups",
        "database_firewall_rules"
      ],
      "code_patterns": {
        "vulnerable_pattern": "publicly_accessible = true",
        "secure_pattern": "publicly_accessible = false"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 8.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-NO_EXCESSIVE_PORT_ACCESS",
      "trivy_rule_info": {
        "original_file": "no_excessive_port_access.yaml",
        "service_category": "network",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/ec2/no_excessive_port_access.yaml"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "PCI-DSS",
        "SOC2",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "port_scanning",
        "service_enumeration"
      ],
      "mitigation_strategies": [
        "restrict_protocol_access",
        "implement_least_privilege",
        "network_segmentation"
      ],
      "code_patterns": {
        "vulnerable_pattern": "protocol = \"all\"",
        "secure_pattern": "protocol = \"tcp\""
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-CLOUDTRAIL-ENCRYPTION_CUSTOMER_KEY",
      "trivy_rule_info": {
        "original_file": "encryption_customer_key.yaml",
        "service_category": "monitoring",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/cloudtrail/encryption_customer_key.yaml"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "GDPR"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "aws_account_access",
        "key_management_requirements"
      ],
      "mitigation_strategies": [
        "implement_customer_managed_kms",
        "enable_key_rotation",
        "audit_key_usage"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_cloudtrail without kms_key_id",
        "secure_pattern": "kms_key_id = aws_kms_key.trail.arn"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-CLOUDTRAIL-ENABLE_LOG_VALIDATION",
      "trivy_rule_info": {
        "original_file": "enable_log_validation.yaml",
        "service_category": "monitoring",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/cloudtrail/enable_log_validation.yaml"
      },
      "vulnerability_class": "audit_integrity",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "HIPAA"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "log_tampering_capability",
        "audit_trail_access"
      ],
      "mitigation_strategies": [
        "enable_log_file_validation",
        "implement_log_monitoring",
        "secure_log_storage"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_cloudtrail without enable_log_file_validation",
        "secure_pattern": "enable_log_file_validation = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "audit_integrity",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-IAM-NO_PASSWORD_REUSE",
      "trivy_rule_info": {
        "original_file": "no_password_reuse.yaml",
        "service_category": "identity",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/iam/no_password_reuse.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "credential_compromise",
        "password_history_access"
      ],
      "mitigation_strategies": [
        "increase_password_reuse_prevention",
        "implement_mfa",
        "password_complexity_requirements"
      ],
      "code_patterns": {
        "vulnerable_pattern": "password_reuse_prevention = 1",
        "secure_pattern": "password_reuse_prevention = 5"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_mapping",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 8,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity MEDIUM,HIGH,CRITICAL .",
      "expected_trivy_output": "8_medium_severity_findings_across_s3_lambda_rds_ec2_cloudtrail_iam"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_enterprise_backup_security_requirements",
      "learn_trivy_based_vulnerability_detection",
      "master_aws_security_best_practices",
      "implement_disaster_recovery_security_controls",
      "apply_compliance_frameworks_to_backup_systems"
    ],
    "prerequisite_knowledge": [
      "basic_aws_services_knowledge",
      "terraform_infrastructure_as_code",
      "backup_and_disaster_recovery_concepts",
      "security_compliance_frameworks"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "backup_systems_require_comprehensive_security_controls",
      "trivy_provides_automated_security_scanning_for_iac",
      "compliance_requirements_drive_security_configurations",
      "defense_in_depth_applies_to_backup_infrastructure",
      "monitoring_and_audit_trails_are_critical_for_backup_systems"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 8,
    "unique_rule_ids": 8,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "aws",
    "language": "terraform",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "lambda",
      "cloudtrail",
      "s3",
      "ec2",
      "iam",
      "rds"
    ]
  },
  "dataset_metadata": {
    "project_id": "corporate-backup-disaster-recovery",
    "generation_timestamp": "2025-08-06T23:02:32.547092",
    "version": "1.0",
    "data_quality": "high"
  }
}