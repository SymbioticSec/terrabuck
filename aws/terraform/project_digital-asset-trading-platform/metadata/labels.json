{
  "project_labels": {
    "project_id": "digital-asset-trading-platform",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 1,
        "high": 1,
        "medium": 5
      },
      "by_type": {
        "encryption": 2,
        "secrets_management": 1,
        "observability": 2,
        "access_control": 2
      },
      "by_trivy_service": {
        "rds": 1,
        "ecs": 1,
        "apigateway": 1,
        "s3": 1,
        "ec2": 1,
        "kms": 1,
        "iam": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "AWS-RDS-ENCRYPT_CLUSTER_STORAGE_DATA",
        "AWS-ECS-NO_PLAINTEXT_SECRETS",
        "AWS-APIGATEWAY-ENABLE_TRACING",
        "AWS-S3-ENABLE_OBJECT_READ_LOGGING",
        "AWS-EC2-REQUIRE_VPC_FLOW_LOGS_FOR_ALL_VPCS",
        "AWS-KMS-AUTO_ROTATE_KEYS",
        "AWS-IAM-REQUIRE_SYMBOLS_IN_PASSWORDS"
      ],
      "services_covered": [
        "rds",
        "ecs",
        "apigateway",
        "s3",
        "ec2",
        "kms",
        "iam"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AWS-RDS-ENCRYPT_CLUSTER_STORAGE_DATA",
      "trivy_rule_info": {
        "original_file": "encrypt_cluster_storage_data.yaml",
        "service_category": "rds",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/rds/encrypt_cluster_storage_data.yaml"
      },
      "vulnerability_class": "encryption_at_rest",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "PCI-DSS",
        "SOX",
        "GDPR",
        "HIPAA"
      ],
      "attack_vector": "physical",
      "prerequisites": [
        "physical_access_to_storage",
        "storage_media_compromise"
      ],
      "mitigation_strategies": [
        "Enable storage_encrypted = true",
        "Configure KMS key for encryption",
        "Implement key rotation policies"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_rds_cluster without storage_encrypted = true",
        "secure_pattern": "aws_rds_cluster with storage_encrypted = true and kms_key_id"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-ECS-NO_PLAINTEXT_SECRETS",
      "trivy_rule_info": {
        "original_file": "no_plaintext_secrets.yaml",
        "service_category": "ecs",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/ecs/no_plaintext_secrets.yaml"
      },
      "vulnerability_class": "secrets_management",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 10,
      "compliance_relevance": [
        "PCI-DSS",
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "ecs_task_access",
        "container_inspection",
        "log_access"
      ],
      "mitigation_strategies": [
        "Use AWS Secrets Manager",
        "Implement secrets injection via environment",
        "Use IAM roles for service authentication"
      ],
      "code_patterns": {
        "vulnerable_pattern": "environment variables with hardcoded passwords/keys",
        "secure_pattern": "secrets referenced from AWS Secrets Manager or Parameter Store"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "secrets_management",
        "severity_numeric": 9.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-APIGATEWAY-ENABLE_TRACING",
      "trivy_rule_info": {
        "original_file": "enable_tracing.yaml",
        "service_category": "apigateway",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/apigateway/enable_tracing.yaml"
      },
      "vulnerability_class": "observability",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "api_access",
        "security_incident_occurrence"
      ],
      "mitigation_strategies": [
        "Enable xray_tracing_enabled = true",
        "Configure X-Ray service permissions",
        "Set up CloudWatch integration"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_api_gateway_stage with xray_tracing_enabled = false or missing",
        "secure_pattern": "aws_api_gateway_stage with xray_tracing_enabled = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "observability",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-S3-ENABLE_OBJECT_READ_LOGGING",
      "trivy_rule_info": {
        "original_file": "enable_object_read_logging.yaml",
        "service_category": "s3",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/s3/enable_object_read_logging.yaml"
      },
      "vulnerability_class": "audit_logging",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOX",
        "PCI-DSS",
        "HIPAA"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "s3_access_permissions",
        "unauthorized_access_attempt"
      ],
      "mitigation_strategies": [
        "Configure CloudTrail with S3 object-level logging",
        "Enable read event tracking",
        "Set up CloudWatch alerts for suspicious access"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_s3_bucket without corresponding CloudTrail object-level logging",
        "secure_pattern": "aws_s3_bucket with CloudTrail event_selector for object read events"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "audit_logging",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-REQUIRE_VPC_FLOW_LOGS_FOR_ALL_VPCS",
      "trivy_rule_info": {
        "original_file": "require_vpc_flow_logs_for_all_vpcs.yaml",
        "service_category": "ec2",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/ec2/require_vpc_flow_logs_for_all_vpcs.yaml"
      },
      "vulnerability_class": "network_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "NIST",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "network_access",
        "lateral_movement_attempt"
      ],
      "mitigation_strategies": [
        "Create aws_flow_log resource for VPC",
        "Configure CloudWatch Logs destination",
        "Enable ALL traffic type logging"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_vpc without corresponding aws_flow_log resource",
        "secure_pattern": "aws_vpc with aws_flow_log configured for ALL traffic"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_monitoring",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-KMS-AUTO_ROTATE_KEYS",
      "trivy_rule_info": {
        "original_file": "auto_rotate_keys.yaml",
        "service_category": "kms",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/kms/auto_rotate_keys.yaml"
      },
      "vulnerability_class": "key_management",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "PCI-DSS",
        "FIPS",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "key_compromise",
        "cryptographic_attack"
      ],
      "mitigation_strategies": [
        "Set enable_key_rotation = true",
        "Implement automated key rotation policies",
        "Monitor key usage patterns"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_kms_key with enable_key_rotation = false or missing",
        "secure_pattern": "aws_kms_key with enable_key_rotation = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "key_management",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-IAM-REQUIRE_SYMBOLS_IN_PASSWORDS",
      "trivy_rule_info": {
        "original_file": "require_symbols_in_passwords.yaml",
        "service_category": "iam",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/iam/require_symbols_in_passwords.yaml"
      },
      "vulnerability_class": "authentication_policy",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 5,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "credential_stuffing",
        "brute_force_attack",
        "dictionary_attack"
      ],
      "mitigation_strategies": [
        "Set require_symbols = true in password policy",
        "Implement multi-factor authentication",
        "Enforce minimum password complexity"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_iam_account_password_policy without require_symbols = true",
        "secure_pattern": "aws_iam_account_password_policy with require_symbols = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "authentication_policy",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_gap_analysis",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,CRITICAL .",
      "expected_trivy_output": "7 vulnerabilities detected across RDS, ECS, API Gateway, S3, VPC, KMS, and IAM resources"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "Understand real-world Trivy security rule implementation",
      "Learn financial services security requirements",
      "Practice vulnerability detection and remediation",
      "Master AWS security best practices",
      "Understand compliance framework mapping"
    ],
    "prerequisite_knowledge": [
      "Basic Terraform syntax",
      "AWS services fundamentals",
      "Security concepts (encryption, access control)",
      "Financial services compliance basics"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "Encryption at rest is mandatory for financial data",
      "Secrets should never be hardcoded in infrastructure",
      "Observability is crucial for incident response",
      "Audit logging enables compliance and forensics",
      "Network monitoring detects lateral movement",
      "Key rotation reduces cryptographic risk",
      "Strong password policies prevent credential attacks"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": true,
    "cloud_provider": "aws",
    "language": "terraform",
    "component_count": 7,
    "file_count": 4,
    "service_categories": [
      "apigateway",
      "s3",
      "ec2",
      "iam",
      "rds",
      "kms",
      "ecs"
    ]
  },
  "dataset_metadata": {
    "project_id": "digital-asset-trading-platform",
    "generation_timestamp": "2025-08-06T23:34:22.717602",
    "version": "1.0",
    "data_quality": "high"
  }
}