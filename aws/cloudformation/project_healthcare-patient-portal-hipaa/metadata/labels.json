{
  "project_labels": {
    "project_id": "healthcare-patient-portal-hipaa",
    "overall_security_posture": "vulnerable",
    "vulnerability_count": {
      "total": 7,
      "by_severity": {
        "critical": 0,
        "high": 0,
        "medium": 7
      },
      "by_type": {
        "access_control": 2,
        "encryption": 2,
        "network": 2,
        "logging": 3
      },
      "by_trivy_service": {
        "s3": 2,
        "ec2": 1,
        "elb": 1,
        "cloudtrail": 2,
        "iam": 1,
        "sqs": 1
      }
    },
    "complexity_score": 8,
    "realism_score": 9,
    "educational_value": 9,
    "trivy_coverage": {
      "rules_represented": [
        "AWS-S3-ENABLE_LOGGING",
        "AWS-ELB-ALB_NOT_PUBLIC",
        "AWS-EC2-NO_PUBLIC_IP",
        "AWS-CLOUDTRAIL-ENSURE_CLOUDWATCH_INTEGRATION",
        "AWS-CLOUDTRAIL-ENABLE_ALL_REGIONS",
        "AWS-IAM-REQUIRE_UPPERCASE_IN_PASSWORDS",
        "AWS-SQS-ENABLE_QUEUE_ENCRYPTION"
      ],
      "services_covered": [
        "s3",
        "elb",
        "ec2",
        "cloudtrail",
        "iam",
        "sqs"
      ],
      "detection_accuracy": "95%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AWS-S3-ENABLE_LOGGING",
      "trivy_rule_info": {
        "original_file": "enable_logging.yaml",
        "service_category": "s3",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/s3/enable_logging.yaml"
      },
      "vulnerability_class": "logging_and_monitoring",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "s3_bucket_access",
        "knowledge_of_missing_logging"
      ],
      "mitigation_strategies": [
        "enable_s3_access_logging",
        "configure_destination_bucket",
        "set_log_file_prefix",
        "implement_log_monitoring"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::S3::Bucket without LoggingConfiguration property",
        "secure_pattern": "AWS::S3::Bucket with LoggingConfiguration.DestinationBucketName and LogFilePrefix"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_and_monitoring",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-ELB-ALB_NOT_PUBLIC",
      "trivy_rule_info": {
        "original_file": "alb_not_public.yaml",
        "service_category": "elb",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/elb/alb_not_public.yaml"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "HIPAA",
        "SOC2"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access",
        "load_balancer_enumeration"
      ],
      "mitigation_strategies": [
        "set_scheme_to_internal",
        "implement_vpn_access",
        "configure_private_subnets",
        "add_security_groups"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::ElasticLoadBalancingV2::LoadBalancer without Scheme property or Scheme: internet-facing",
        "secure_pattern": "AWS::ElasticLoadBalancingV2::LoadBalancer with Scheme: internal"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-NO_PUBLIC_IP",
      "trivy_rule_info": {
        "original_file": "no_public_ip.yaml",
        "service_category": "ec2",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/ec2/no_public_ip.yaml"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 8,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access",
        "port_scanning",
        "service_enumeration"
      ],
      "mitigation_strategies": [
        "remove_associatepublicipaddress_property",
        "deploy_to_private_subnets",
        "use_nat_gateway_for_outbound",
        "implement_bastion_host_architecture"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::AutoScaling::LaunchConfiguration with AssociatePublicIpAddress: true",
        "secure_pattern": "AWS::AutoScaling::LaunchConfiguration without AssociatePublicIpAddress property"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 7.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-CLOUDTRAIL-ENSURE_CLOUDWATCH_INTEGRATION",
      "trivy_rule_info": {
        "original_file": "ensure_cloudwatch_integration.yaml",
        "service_category": "cloudtrail",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/cloudtrail/ensure_cloudwatch_integration.yaml"
      },
      "vulnerability_class": "logging_and_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "aws_api_access",
        "delayed_detection_window"
      ],
      "mitigation_strategies": [
        "configure_cloudwatch_logs_integration",
        "set_cloudwatchlogsloggrouparn",
        "create_cloudwatch_alarms",
        "implement_real_time_monitoring"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::CloudTrail::Trail without CloudWatchLogsLogGroupArn property",
        "secure_pattern": "AWS::CloudTrail::Trail with CloudWatchLogsLogGroupArn configured"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_and_monitoring",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-CLOUDTRAIL-ENABLE_ALL_REGIONS",
      "trivy_rule_info": {
        "original_file": "enable_all_regions.yaml",
        "service_category": "cloudtrail",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/cloudtrail/enable_all_regions.yaml"
      },
      "vulnerability_class": "logging_and_monitoring",
      "detection_difficulty": "medium",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "multi_region_access",
        "cross_region_activities"
      ],
      "mitigation_strategies": [
        "set_ismultiregiontrail_true",
        "enable_global_service_events",
        "configure_cross_region_replication",
        "implement_centralized_logging"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::CloudTrail::Trail with IsMultiRegionTrail: false or property omitted",
        "secure_pattern": "AWS::CloudTrail::Trail with IsMultiRegionTrail: true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "logging_and_monitoring",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-IAM-REQUIRE_UPPERCASE_IN_PASSWORDS",
      "trivy_rule_info": {
        "original_file": "require_uppercase_in_passwords.yaml",
        "service_category": "iam",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/iam/require_uppercase_in_passwords.yaml"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "credential_stuffing",
        "brute_force_attacks",
        "weak_passwords"
      ],
      "mitigation_strategies": [
        "set_require_uppercase_characters_true",
        "implement_strong_password_policy",
        "enable_mfa",
        "regular_password_rotation"
      ],
      "code_patterns": {
        "vulnerable_pattern": "aws_iam_account_password_policy without require_uppercase_characters property",
        "secure_pattern": "aws_iam_account_password_policy with require_uppercase_characters = true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-SQS-ENABLE_QUEUE_ENCRYPTION",
      "trivy_rule_info": {
        "original_file": "enable_queue_encryption.yaml",
        "service_category": "sqs",
        "source_url": "https://github.com/aquasecurity/trivy-checks/blob/main/checks/cloud/aws/sqs/enable_queue_encryption.yaml"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "HIPAA",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "message_interception",
        "queue_access",
        "network_sniffing"
      ],
      "mitigation_strategies": [
        "configure_kmsmasterkeyid",
        "use_aws_managed_keys",
        "implement_customer_managed_keys",
        "enable_encryption_in_transit"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::SQS::Queue without KmsMasterKeyId property",
        "secure_pattern": "AWS::SQS::Queue with KmsMasterKeyId configured"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 7.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_checking",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity MEDIUM,HIGH,CRITICAL .",
      "expected_trivy_output": "7 medium severity findings across s3, elb, ec2, cloudtrail, iam, and sqs services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_hipaa_compliance_requirements_in_cloud_infrastructure",
      "learn_trivy_security_scanning_for_healthcare_applications",
      "master_aws_security_best_practices_for_phi_protection",
      "implement_defense_in_depth_for_patient_portal_systems",
      "configure_comprehensive_audit_logging_for_healthcare_compliance"
    ],
    "prerequisite_knowledge": [
      "basic_aws_services_knowledge",
      "understanding_of_hipaa_requirements",
      "infrastructure_as_code_concepts",
      "cloud_security_fundamentals",
      "healthcare_data_protection_principles"
    ],
    "difficulty_level": "intermediate",
    "estimated_review_time": 45,
    "key_takeaways": [
      "healthcare_applications_require_comprehensive_logging_for_phi_access_tracking",
      "network_isolation_is_critical_for_protecting_patient_data_in_cloud_environments",
      "encryption_at_rest_and_in_transit_is_mandatory_for_hipaa_compliance",
      "trivy_can_automatically_detect_common_healthcare_security_misconfigurations",
      "multi_region_audit_trails_prevent_blind_spots_in_security_monitoring",
      "strong_authentication_policies_are_essential_for_healthcare_system_access"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 7,
    "unique_rule_ids": 7,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "aws",
    "language": "cloudformation",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "sqs",
      "elb",
      "iam",
      "s3",
      "cloudtrail",
      "ec2"
    ]
  },
  "dataset_metadata": {
    "project_id": "healthcare-patient-portal-hipaa",
    "generation_timestamp": "2025-08-08T15:52:28.184050",
    "version": "1.0",
    "data_quality": "medium"
  }
}