{
  "project_labels": {
    "project_id": "digital-asset-custody-platform",
    "overall_security_posture": "critical",
    "vulnerability_count": {
      "total": 8,
      "by_severity": {
        "critical": 0,
        "high": 4,
        "medium": 4
      },
      "by_type": {
        "access_control": 3,
        "encryption": 3,
        "monitoring": 2
      },
      "by_trivy_service": {
        "s3": 3,
        "ec2": 3,
        "rds": 1,
        "lambda": 1
      }
    },
    "complexity_score": 9,
    "realism_score": 10,
    "educational_value": 10,
    "trivy_coverage": {
      "rules_represented": [
        "AWS-S3-NO_PUBLIC_BUCKETS",
        "AWS-RDS-ENCRYPT_INSTANCE_STORAGE_DATA",
        "AWS-EC2-NO_SECRETS_IN_USER_DATA",
        "AWS-LAMBDA-ENABLE_TRACING",
        "AWS-EC2-ENABLE_AT_REST_ENCRYPTION",
        "AWS-S3-ENABLE_VERSIONING",
        "AWS-EC2-NO_PUBLIC_INGRESS_SGR",
        "AWS-S3-ENABLE_LOGGING"
      ],
      "services_covered": [
        "s3",
        "ec2",
        "rds",
        "lambda"
      ],
      "detection_accuracy": "100%"
    }
  },
  "vulnerability_labels": [
    {
      "rule_id": "AWS-S3-NO_PUBLIC_BUCKETS",
      "trivy_rule_info": {
        "original_file": "no_public_buckets.yaml",
        "service_category": "s3",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/s3"
      },
      "vulnerability_class": "access_control",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 10,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access",
        "bucket_name_knowledge"
      ],
      "mitigation_strategies": [
        "enable_public_access_block",
        "restrict_public_buckets",
        "implement_bucket_policies",
        "use_vpc_endpoints"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::S3::Bucket without PublicAccessBlockConfiguration",
        "secure_pattern": "AWS::S3::Bucket with PublicAccessBlockConfiguration.RestrictPublicBuckets: true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "access_control",
        "severity_numeric": 9.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-RDS-ENCRYPT_INSTANCE_STORAGE_DATA",
      "trivy_rule_info": {
        "original_file": "encrypt_instance_storage_data.yaml",
        "service_category": "rds",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/rds"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 9,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "PCI-DSS",
        "HIPAA"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "physical_access_to_storage",
        "privileged_access"
      ],
      "mitigation_strategies": [
        "enable_storage_encryption",
        "use_kms_keys",
        "implement_key_rotation",
        "encrypt_backups"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::RDS::DBInstance with StorageEncrypted: false or missing",
        "secure_pattern": "AWS::RDS::DBInstance with StorageEncrypted: true and KmsKeyId"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-NO_SECRETS_IN_USER_DATA",
      "trivy_rule_info": {
        "original_file": "no_secrets_in_user_data.yaml",
        "service_category": "ec2",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/ec2"
      },
      "vulnerability_class": "credential_exposure",
      "detection_difficulty": "medium",
      "remediation_effort": "medium",
      "business_impact_score": 10,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "NIST"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "instance_metadata_access",
        "user_data_access"
      ],
      "mitigation_strategies": [
        "use_parameter_store",
        "use_secrets_manager",
        "implement_iam_roles",
        "use_instance_profiles"
      ],
      "code_patterns": {
        "vulnerable_pattern": "UserData containing hardcoded passwords or API keys",
        "secure_pattern": "UserData referencing SSM parameters or IAM roles"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "credential_exposure",
        "severity_numeric": 9.0,
        "should_flag": true,
        "auto_remediable": false,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-LAMBDA-ENABLE_TRACING",
      "trivy_rule_info": {
        "original_file": "enable_tracing.yaml",
        "service_category": "lambda",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/lambda"
      },
      "vulnerability_class": "monitoring",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 6,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "adjacent",
      "prerequisites": [
        "compliance_requirements",
        "audit_needs"
      ],
      "mitigation_strategies": [
        "enable_x_ray_tracing",
        "configure_active_mode",
        "implement_distributed_tracing",
        "set_up_monitoring_dashboards"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::Lambda::Function without TracingConfig",
        "secure_pattern": "AWS::Lambda::Function with TracingConfig.Mode: Active"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 5.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-ENABLE_AT_REST_ENCRYPTION",
      "trivy_rule_info": {
        "original_file": "enable_at_rest_encryption.yaml",
        "service_category": "ec2",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/ec2"
      },
      "vulnerability_class": "encryption",
      "detection_difficulty": "easy",
      "remediation_effort": "medium",
      "business_impact_score": 7,
      "compliance_relevance": [
        "GDPR",
        "SOC2",
        "PCI-DSS"
      ],
      "attack_vector": "local",
      "prerequisites": [
        "physical_storage_access",
        "snapshot_access"
      ],
      "mitigation_strategies": [
        "enable_ebs_encryption",
        "use_kms_keys",
        "encrypt_snapshots",
        "implement_default_encryption"
      ],
      "code_patterns": {
        "vulnerable_pattern": "BlockDeviceMappings with Ebs.Encrypted: false",
        "secure_pattern": "BlockDeviceMappings with Ebs.Encrypted: true"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "encryption",
        "severity_numeric": 6.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-S3-ENABLE_VERSIONING",
      "trivy_rule_info": {
        "original_file": "enable_versioning.yaml",
        "service_category": "s3",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/s3"
      },
      "vulnerability_class": "data_protection",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 8,
      "compliance_relevance": [
        "SOC2",
        "ISO27001"
      ],
      "attack_vector": "adjacent",
      "prerequisites": [
        "s3_write_access",
        "accidental_deletion"
      ],
      "mitigation_strategies": [
        "enable_versioning",
        "configure_mfa_delete",
        "implement_lifecycle_policies",
        "set_up_cross_region_replication"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::S3::Bucket without VersioningConfiguration",
        "secure_pattern": "AWS::S3::Bucket with VersioningConfiguration.Status: Enabled"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "data_protection",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-EC2-NO_PUBLIC_INGRESS_SGR",
      "trivy_rule_info": {
        "original_file": "no_public_ingress_sgr.yaml",
        "service_category": "ec2",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/ec2"
      },
      "vulnerability_class": "network_security",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 9,
      "compliance_relevance": [
        "SOC2",
        "PCI-DSS",
        "ISO27001"
      ],
      "attack_vector": "network",
      "prerequisites": [
        "internet_access",
        "port_scanning"
      ],
      "mitigation_strategies": [
        "restrict_cidr_blocks",
        "use_specific_ip_ranges",
        "implement_vpc_security",
        "configure_nacls"
      ],
      "code_patterns": {
        "vulnerable_pattern": "SecurityGroupIngress with CidrIp: 0.0.0.0/0",
        "secure_pattern": "SecurityGroupIngress with specific CIDR blocks"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "network_security",
        "severity_numeric": 8.5,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    },
    {
      "rule_id": "AWS-S3-ENABLE_LOGGING",
      "trivy_rule_info": {
        "original_file": "enable_logging.yaml",
        "service_category": "s3",
        "source_url": "https://github.com/aquasecurity/trivy-checks/tree/main/checks/cloud/aws/s3"
      },
      "vulnerability_class": "monitoring",
      "detection_difficulty": "easy",
      "remediation_effort": "low",
      "business_impact_score": 7,
      "compliance_relevance": [
        "SOC2",
        "ISO27001",
        "PCI-DSS"
      ],
      "attack_vector": "adjacent",
      "prerequisites": [
        "audit_requirements",
        "forensic_analysis_needs"
      ],
      "mitigation_strategies": [
        "enable_access_logging",
        "configure_cloudtrail",
        "set_up_log_analysis",
        "implement_siem_integration"
      ],
      "code_patterns": {
        "vulnerable_pattern": "AWS::S3::Bucket without LoggingConfiguration",
        "secure_pattern": "AWS::S3::Bucket with LoggingConfiguration.DestinationBucketName"
      },
      "training_labels": {
        "is_vulnerable": true,
        "vulnerability_type": "monitoring",
        "severity_numeric": 6.0,
        "should_flag": true,
        "auto_remediable": true,
        "trivy_detectable": true
      }
    }
  ],
  "ml_metadata": {
    "suitable_for_tasks": [
      "vulnerability_detection",
      "severity_classification",
      "auto_remediation",
      "trivy_rule_matching",
      "compliance_checking",
      "security_posture_assessment"
    ],
    "data_splits": {
      "recommended_train": 0.7,
      "recommended_val": 0.15,
      "recommended_test": 0.15
    },
    "sampling_weight": 9,
    "annotation_confidence": "high",
    "requires_domain_knowledge": true,
    "trivy_integration": {
      "can_validate_with_trivy": true,
      "trivy_scan_command": "trivy config --format json --severity HIGH,CRITICAL .",
      "expected_trivy_output": "8 vulnerabilities across S3, EC2, RDS, and Lambda services"
    }
  },
  "educational_metadata": {
    "learning_objectives": [
      "understand_trivy_security_scanning",
      "identify_aws_misconfigurations",
      "learn_infrastructure_as_code_security",
      "practice_vulnerability_remediation",
      "understand_compliance_requirements",
      "learn_defense_in_depth_principles"
    ],
    "prerequisite_knowledge": [
      "basic_aws_services",
      "cloudformation_syntax",
      "security_fundamentals",
      "compliance_frameworks"
    ],
    "difficulty_level": "advanced",
    "estimated_review_time": 45,
    "key_takeaways": [
      "trivy_detects_real_world_vulnerabilities",
      "infrastructure_security_requires_multiple_layers",
      "compliance_drives_security_requirements",
      "automation_enables_consistent_security",
      "financial_services_have_strict_requirements"
    ],
    "trivy_learning_value": {
      "demonstrates_trivy_capabilities": true,
      "real_world_applicability": "high",
      "rule_complexity": "moderate"
    }
  },
  "computed_metrics": {
    "total_vulnerabilities": 8,
    "unique_rule_ids": 8,
    "has_critical_vulnerabilities": false,
    "cloud_provider": "aws",
    "language": "cloudformation",
    "component_count": 6,
    "file_count": 4,
    "service_categories": [
      "rds",
      "lambda",
      "ec2",
      "s3"
    ]
  },
  "dataset_metadata": {
    "project_id": "digital-asset-custody-platform",
    "generation_timestamp": "2025-08-08T16:10:23.978960",
    "version": "1.0",
    "data_quality": "high"
  }
}